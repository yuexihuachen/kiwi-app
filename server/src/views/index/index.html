<!DOCTYPE html>
    <head>
        <title>index</title>
        <style>
            body {
                background-color: #333;
                color: white;
            }
        </style>
    </head>
<body><div id="root"><div class="bg__container"><header id="navbar" class="bd-navbar navbar"><div class="navbar-brand"><a href="/" class="navbar-item is-size-5">技术博客</a><a href="/write" class="navbar-item is-size-5">新建笔记</a><button id="navbarBurger" class="navbar-burger "><span></span><span></span><span></span></button></div><div id="navMenuDocumentation" class="navbar-menu "><div id="navbarStartOriginal" class="navbar-end is-size-5"><a class="navbar-item is-active"><span>JavaScript</span></a><a class="navbar-item "><span>NodeJs</span></a><a class="navbar-item "><span>Css</span></a><a class="navbar-item "><span>React</span></a><a class="navbar-item "><span>构建工具</span></a><a class="navbar-item "><span>前端架构</span></a><a class="navbar-item "><span>数据结构</span></a><a class="navbar-item "><span>算法</span></a><a class="navbar-item "><span>设计模式</span></a><div class="navbar-item is-hoverable"><a class="navbar-link is-link"><span>其他</span></a><div class="navbar-dropdown is-boxed"><a class="navbar-item is-size-6 "><strong>Docker</strong></a><a class="navbar-item is-size-6 "><strong>Linux</strong></a><a class="navbar-item is-size-6 "><strong>WebAssembly</strong></a><a class="navbar-item is-size-6 "><strong>数据可视化</strong></a><a class="navbar-item is-size-6 "><strong>后端</strong></a><a class="navbar-item is-size-6 "><strong>数据库</strong></a><a class="navbar-item is-size-6 "><strong>扩展</strong></a></div></div></div></div></header><div id="docsToggles" class="bd-docs-toggles"><button class="button is-primary is-light bd-fat-button " id="docsNavButton">显示列表</button></div><div class="blog__body"><aside class="bd-aside "><section class="sidebar-links"><div class="sidebar-heading"></div><ul class="sidebar-ul sidebar-group-items"><li class="sidebar-items">高阶函数</li><li class="">闭包的作用</li><li class="">深拷贝和浅拷贝</li><li class="">bind实现</li><li class="">并行和串行</li><li class="">web事件循环</li><li class="">浏览器的渲染</li><li class="">Promise原理</li><li class="">Promise静态方法</li></ul></section></aside><main class="bd-main"><div class="content markdown-body"><h1>高阶函数</h1>
<hr>
<h2>函数作为返回值返回</h2>
<ul>
<li>判断一个数据是否是数组（字符串,数字），实现如下：</li>
</ul>
<pre><div style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code class="language-javascript" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span class="token" style="color: rgb(198, 120, 221);">const</span><span> </span><span class="token maybe-class-name">Type</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token control-flow" style="color: rgb(198, 120, 221);">for</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">let</span><span> i </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">0</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> type</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span> type </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">[</span><span class="token" style="color: rgb(152, 195, 121);">'String'</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> </span><span class="token" style="color: rgb(152, 195, 121);">'Array'</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> </span><span class="token" style="color: rgb(152, 195, 121);">'Number'</span><span class="token" style="color: rgb(171, 178, 191);">]</span><span class="token" style="color: rgb(171, 178, 191);">[</span><span>i</span><span class="token" style="color: rgb(97, 175, 239);">++</span><span class="token" style="color: rgb(171, 178, 191);">]</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">type</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token maybe-class-name">Type</span><span class="token" style="color: rgb(171, 178, 191);">[</span><span class="token" style="color: rgb(152, 195, 121);">'is'</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">+</span><span> type</span><span class="token" style="color: rgb(171, 178, 191);">]</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">obj</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>            </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">Object</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">prototype</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">toString</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">call</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>obj</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">===</span><span> </span><span class="token" style="color: rgb(152, 195, 121);">'[object '</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">+</span><span> type </span><span class="token" style="color: rgb(97, 175, 239);">+</span><span> </span><span class="token" style="color: rgb(152, 195, 121);">']'</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>type</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token maybe-class-name">Type</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">isArray</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">[</span><span class="token" style="color: rgb(171, 178, 191);">]</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span> </span><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// 输出： true</span><span>
</span><span></span><span class="token maybe-class-name">Type</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">isString</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"str"</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span> </span><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// 输出： true</span></code></div></pre>
<hr>
<h2>AOP（面向切面编程）</h2>
<ul>
<li>跟核心业务无关的功能抽离出来，比如日志统计、安全控制、异常处理等。通过动态的方式掺入业务逻辑模块中</li>
</ul>
<pre><div style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code class="language-javascript" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span class="token" style="color: rgb(209, 154, 102);">Function</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">prototype</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method-variable function-variable method property-access" style="color: rgb(97, 175, 239);">before</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">beforefn</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token" style="color: rgb(198, 120, 221);">const</span><span> __self </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">this</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        beforefn</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">apply</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">this</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> arguments</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> __self</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">apply</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">this</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> arguments</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(209, 154, 102);">Function</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">prototype</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method-variable function-variable method property-access" style="color: rgb(97, 175, 239);">after</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">afterfn</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token" style="color: rgb(198, 120, 221);">const</span><span> __self </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">this</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token" style="color: rgb(198, 120, 221);">const</span><span> ret </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> __self</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">apply</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">this</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> arguments</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        afterfn</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">apply</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">this</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> arguments</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> ret</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(198, 120, 221);">const</span><span> </span><span class="token function-variable" style="color: rgb(97, 175, 239);">getUserInfo</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token console" style="color: rgb(209, 154, 102);">console</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">log</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"hello world!"</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(198, 120, 221);">const</span><span> funcAop </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> getUserInfo</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">before</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token console" style="color: rgb(209, 154, 102);">console</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">log</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"before report"</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">after</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token console" style="color: rgb(209, 154, 102);">console</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">log</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"after report"</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(97, 175, 239);">funcAop</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span></code></div></pre>
<hr>
<h2>函数柯里化（function currying）</h2>
<ul>
<li>函数柯里化又称部分求值。一个柯里化的函数首先会接受一些参数，接受了这些参数之后，该函数并不会立即求值，而是继续返回另外一个函数，刚才传入的参数在函数形成的闭包中被保存起来。待到函数被真正需要求值的时候，之前传入的所有参数都会被用于求值。</li>
</ul>
<pre><div style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code class="language-javascript" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// 是一项将一个调用形式为f(a,b,c)的函数转化为调用形式为f(a)(b)(c)的技术。</span><span>
</span><span></span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">currying</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">func</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">curried</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter spread" style="color: rgb(97, 175, 239);">...</span><span class="token parameter">args</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token control-flow" style="color: rgb(198, 120, 221);">if</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>args</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">&gt;=</span><span> func</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">length</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>            </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> func</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">apply</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">this</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> args</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span> </span><span class="token control-flow" style="color: rgb(198, 120, 221);">else</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>            </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter spread" style="color: rgb(97, 175, 239);">...</span><span class="token parameter">args2</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>                </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> curried</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">apply</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">this</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> args</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">concat</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>args2</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>            </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span>        </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">sum</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">a</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> b</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> c</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> a </span><span class="token" style="color: rgb(97, 175, 239);">+</span><span> b </span><span class="token" style="color: rgb(97, 175, 239);">+</span><span> c</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(198, 120, 221);">let</span><span> carriedSum </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">currying</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>sum</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// 支持正常的调用</span><span>
</span><span></span><span class="token console" style="color: rgb(209, 154, 102);">console</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">log</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(97, 175, 239);">carriedSum</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(209, 154, 102);">1</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">2</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">6</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token console" style="color: rgb(209, 154, 102);">console</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">log</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(97, 175, 239);">carriedSum</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(209, 154, 102);">1</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(209, 154, 102);">2</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">6</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token console" style="color: rgb(209, 154, 102);">console</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">log</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(97, 175, 239);">carriedSum</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(209, 154, 102);">1</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(209, 154, 102);">2</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(209, 154, 102);">6</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span></code></div></pre>
<p>::: tip
高级的柯里化同时允许函数正常调用和获取偏函数。
:::</p>
<hr>
<h2>函数节流</h2>
<blockquote>
<p>在指定的时间间隔内只会执行一次任务，例如window.onscroll判断是否滚动到页面底部（翻页功能），频繁的触发函数很消耗性能。我们通过函数节流来保证每隔一段时间执行一次原本需要无时不刻地在执行的函数（多次滚动触发多次的函数的计算逻辑）。</p>
</blockquote>
<ul>
<li>高频事件触发，但在n秒内只会执行一次，所以节流会稀释函数的执行频率</li>
</ul>
<h4>函数被频繁触发的场景</h4>
<ol>
<li>window.onresize</li>
<li>mousemove</li>
<li>进度条的拖动</li>
<li>window.sroll</li>
</ol>
<pre><div style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code class="language-javascript" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span class="token" style="color: rgb(198, 120, 221);">const</span><span> </span><span class="token function-variable" style="color: rgb(97, 175, 239);">scrollFun</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token" style="color: rgb(198, 120, 221);">const</span><span> pageHeight </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token dom" style="color: rgb(97, 175, 239);">document</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">body</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">offsetHeight</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">||</span><span> </span><span class="token dom" style="color: rgb(97, 175, 239);">document</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">documentElement</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">offsetHeight</span><span>
</span><span>    </span><span class="token" style="color: rgb(198, 120, 221);">const</span><span> scrollHeight </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token dom" style="color: rgb(97, 175, 239);">document</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">documentElement</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">scrollTop</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">||</span><span> </span><span class="token dom" style="color: rgb(97, 175, 239);">window</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">pageYOffset</span><span>
</span><span>    </span><span class="token" style="color: rgb(198, 120, 221);">const</span><span> windowHeight </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token dom" style="color: rgb(97, 175, 239);">window</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">innerHeight</span><span>
</span><span>    </span><span class="token" style="color: rgb(198, 120, 221);">let</span><span> diffHeight </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> pageHeight </span><span class="token" style="color: rgb(97, 175, 239);">-</span><span> scrollHeight </span><span class="token" style="color: rgb(97, 175, 239);">-</span><span> windowHeight
</span><span>    </span><span class="token control-flow" style="color: rgb(198, 120, 221);">if</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>diffHeight </span><span class="token" style="color: rgb(97, 175, 239);">&gt;</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">-</span><span class="token" style="color: rgb(209, 154, 102);">50</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">&amp;&amp;</span><span> diffHeight </span><span class="token" style="color: rgb(97, 175, 239);">&lt;</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">50</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token console" style="color: rgb(209, 154, 102);">console</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">log</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"to end"</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// window.onscroll = scrollFun // 频繁的触发函数</span><span>
</span><span></span><span class="token dom" style="color: rgb(97, 175, 239);">window</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">onscroll</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">throttle</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>scrollFun</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// 300毫秒以内执行一次</span><span>
</span><span></span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">throttle</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">fn</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> interval </span><span class="token parameter" style="color: rgb(97, 175, 239);">=</span><span class="token parameter"> </span><span class="token parameter" style="color: rgb(209, 154, 102);">300</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token" style="color: rgb(198, 120, 221);">let</span><span> canRun </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">true</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token control-flow" style="color: rgb(198, 120, 221);">if</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(97, 175, 239);">!</span><span>canRun</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        canRun </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">false</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        </span><span class="token" style="color: rgb(97, 175, 239);">setTimeout</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token arrow" style="color: rgb(97, 175, 239);">=&gt;</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>            fn</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">apply</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">this</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> arguments</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>            canRun </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">true</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> interval</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span></code></div></pre>
<hr>
<h2>函数防抖</h2>
<ul>
<li>任务频繁触发的情况下，只有任务触发的间隔超过指定间隔的时候，任务才会执行,在指定时间内再次触发重新计时。</li>
<li>触发高频事件后n秒内函数只会执行一次，如果n秒内高频事件再次被触发，则重新计算时间，例如input输入</li>
</ul>
<pre><div style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code class="language-javascript" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span class="token" style="color: rgb(198, 120, 221);">const</span><span> inputDom </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token dom" style="color: rgb(97, 175, 239);">document</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">getElementById</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"input"</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span>
</span><span></span><span class="token" style="color: rgb(198, 120, 221);">const</span><span> </span><span class="token function-variable" style="color: rgb(97, 175, 239);">callbackFun</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token" style="color: rgb(97, 175, 239);">fetch</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">'/'</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">then</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">response</span><span> </span><span class="token arrow" style="color: rgb(97, 175, 239);">=&gt;</span><span> response</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">json</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">then</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">res</span><span> </span><span class="token arrow" style="color: rgb(97, 175, 239);">=&gt;</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token console" style="color: rgb(209, 154, 102);">console</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">log</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"input"</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// 每输入一个字符发送一个请求，用户体验很不好和服务器的压力很大。</span><span>
</span><span></span><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// inputDom.addEventListener("input", callbackFun)</span><span>
</span><span></span><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// 控制在超过300毫秒执行一次，如果在300毫秒以内再次输入，重新计时</span><span>
</span><span>inputDom</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">addEventListener</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"input"</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">debounce</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>callbackFun</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span>
</span><span></span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">debounce</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">fn</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> interval </span><span class="token parameter" style="color: rgb(97, 175, 239);">=</span><span class="token parameter"> </span><span class="token parameter" style="color: rgb(209, 154, 102);">300</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token" style="color: rgb(198, 120, 221);">let</span><span> timeout </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token nil" style="color: rgb(198, 120, 221);">null</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token" style="color: rgb(97, 175, 239);">clearTimeout</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>timeout</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        timeout </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">setTimeout</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token arrow" style="color: rgb(97, 175, 239);">=&gt;</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>            fn</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">apply</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(198, 120, 221);">this</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> arguments</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> interval</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span></code></div></pre>
<hr>
<h2>惰性载入函数</h2>
<ul>
<li>为了支持跨浏览器处理事件，我们会开发一些合适的事件处理的方法。该方法包含了一些if判断逻辑，为了避免if逻辑每次都执行（代码执行的更快），我们可以采用惰性载入方式重写createEvent函数，在函数内部被覆盖成另一个适合的函数，这样对原函数调用不用经过if判断。</li>
</ul>
<pre><div style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code class="language-javascript" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">createEvent</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">element</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> type</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> handler</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token control-flow" style="color: rgb(198, 120, 221);">if</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>element</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">addEventListener</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        element</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">addEventListener</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>type</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> handler</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">false</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span> </span><span class="token control-flow" style="color: rgb(198, 120, 221);">else</span><span> </span><span class="token control-flow" style="color: rgb(198, 120, 221);">if</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>element</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">attachEvent</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        element</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">attachEvent</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"on"</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">+</span><span> type</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> handler</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span> </span><span class="token control-flow" style="color: rgb(198, 120, 221);">else</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        element</span><span class="token" style="color: rgb(171, 178, 191);">[</span><span class="token" style="color: rgb(152, 195, 121);">"on"</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">+</span><span> type</span><span class="token" style="color: rgb(171, 178, 191);">]</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> handler</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// 惰性载入函数方案</span><span>
</span><span></span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">createEvent</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">element</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> type</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> handler</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>    </span><span class="token control-flow" style="color: rgb(198, 120, 221);">if</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>element</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">addEventListener</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token function-variable" style="color: rgb(97, 175, 239);">createEvent</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">element</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> type</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> handler</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>            element</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">addEventListener</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>type</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> handler</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> </span><span class="token" style="color: rgb(209, 154, 102);">false</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span> </span><span class="token control-flow" style="color: rgb(198, 120, 221);">else</span><span> </span><span class="token control-flow" style="color: rgb(198, 120, 221);">if</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>element</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token property-access">attachEvent</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token function-variable" style="color: rgb(97, 175, 239);">createEvent</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">element</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> type</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> handler</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>            element</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">attachEvent</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"on"</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">+</span><span> type</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> handler</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span> </span><span class="token control-flow" style="color: rgb(198, 120, 221);">else</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token function-variable" style="color: rgb(97, 175, 239);">createEvent</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token parameter">element</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> type</span><span class="token parameter" style="color: rgb(171, 178, 191);">,</span><span class="token parameter"> handler</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>            element</span><span class="token" style="color: rgb(171, 178, 191);">[</span><span class="token" style="color: rgb(152, 195, 121);">"on"</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">+</span><span> type</span><span class="token" style="color: rgb(171, 178, 191);">]</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">=</span><span> handler</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span>        </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span>    </span><span class="token control-flow" style="color: rgb(198, 120, 221);">return</span><span> </span><span class="token" style="color: rgb(97, 175, 239);">createEvent</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>element</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> type</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span> handler</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">;</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(92, 99, 112); font-style: italic;">// 后续每次调用不用再走if逻辑</span><span>
</span><span></span><span class="token" style="color: rgb(97, 175, 239);">createEvent</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span>
</span><span>    </span><span class="token dom" style="color: rgb(97, 175, 239);">document</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">getElementById</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"input"</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span>
</span><span>    </span><span class="token" style="color: rgb(152, 195, 121);">"input"</span><span class="token" style="color: rgb(171, 178, 191);">,</span><span>
</span><span>    </span><span class="token" style="color: rgb(198, 120, 221);">function</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span> </span><span class="token" style="color: rgb(171, 178, 191);">{</span><span>
</span><span>        </span><span class="token console" style="color: rgb(209, 154, 102);">console</span><span class="token" style="color: rgb(171, 178, 191);">.</span><span class="token method property-access" style="color: rgb(97, 175, 239);">log</span><span class="token" style="color: rgb(171, 178, 191);">(</span><span class="token" style="color: rgb(152, 195, 121);">"input"</span><span class="token" style="color: rgb(171, 178, 191);">)</span><span>
</span><span>    </span><span class="token" style="color: rgb(171, 178, 191);">}</span><span>
</span><span></span><span class="token" style="color: rgb(171, 178, 191);">)</span></code></div></pre></div></main></div></div></div><!-- <footer class="footer"><div class="content has-text-centered"><p>MIT Licensed | Copyright © 2022-present HaiDong Wang</p></div></footer>  -->

<i id="__PIKPAK_EXTENSION__" style="display: none;"></i></body>
</html>